\documentclass{article}
\usepackage[margin=1.5cm]{geometry}
\usepackage{xcolor} % For custom colors
\usepackage{listings}
\usepackage{graphicx}
\graphicspath{ {./images/Lab3} }

% Define SQL style
\lstdefinelanguage{SQL}{
  morekeywords={
    ALTER, ADD, DROP, SELECT, FROM, WHERE, AND, OR, INSERT, INTO, VALUES, UPDATE, SET, DELETE,
    CREATE, TABLE, PRIMARY, KEY, FOREIGN, NOT, NULL, REFERENCES, INNER, JOIN, CONSTRAINT,
    LEFT, RIGHT, FULL, ON, AS, DISTINCT, GROUP, BY, ORDER, HAVING, LIMIT, UNIQUE, CASCADE, DEFAULT,
    RENAME, DESCRIBE, TO, IN, IF, CASE, WHEN, THEN, ELSE, END
  },
  sensitive=false,
  morecomment=[l]{--}, % SQL single-line comments
  morecomment=[s]{/*}{*/}, % SQL multi-line comments
  morestring=[b]', % Strings in single quotes
}
\lstset{language=SQL,
    numbers=left,
    basicstyle=\ttfamily,
    showstringspaces=false,
    keywordstyle=\color{blue}\bfseries,
    commentstyle=\color{orange}\itshape,
    stringstyle=\color{green},
    frame=single,
    breaklines=true
}
    
\begin{document}
\title{CSCD 327 Lab 3}
\author{Dustin Randall}
\maketitle

\section{Find old rich teams}
\begin{lstlisting}
SELECT team_name, city FROM teams
WHERE founded_year < 1990 AND budget_million > 120;
\end{lstlisting}

\begin{figure}[ht]
    \centering
    \includegraphics{OldRich.png}
    \caption{Finding old rich teams}
\end{figure}
\pagebreak

\section{Find players on teams 1, 3, 5}
\begin{lstlisting}
SELECT playerID, first_name, last_name
FROM players
WHERE teamID IN (1, 3, 5)
ORDER BY playerID;
\end{lstlisting}

\begin{figure}[ht]
    \centering
    \includegraphics{Find135.png}
    \caption{Finding Players on Teams 1, 3, 5}
\end{figure}
\pagebreak

\section{Find matches with teams 2 and 3 in April}
\begin{lstlisting}
SELECT matchID, match_date FROM matches
WHERE (match_date BETWEEN '2025-04-01' AND '2025-04-30')
    AND (home_teamID IN (2, 3) OR away_teamID IN(2, 3));
\end{lstlisting}
\begin{figure}[ht]
    \centering
    \includegraphics{AprilMatches.png}
    \caption{Finding matches with teams 2 and 3 in April}
\end{figure}
\pagebreak

\section{Find ams and ons}
\begin{lstlisting}
SELECT playerID FROM players
WHERE (first_name LIKE '%am%' OR first_name LIKE '%on%')
    OR (last_name LIKE '%am%' OR last_name LIKE '%on%');
\end{lstlisting}
\begin{figure}[ht]
    \centering
    \includegraphics{AmandOn.png}
    \caption{Finding players with names containing 'am' or 'on'}
\end{figure}
\pagebreak

\section{Get Full Names of Young players}
\begin{lstlisting}
SELECT playerID, CONCAT(first_name, ' ', last_name) AS full_name 
FROM players
WHERE date_of_birth > '1999-01-01'
\end{lstlisting}
\begin{figure}[ht]
    \centering
    \includegraphics{YoungPlayers.png}
    \caption{Getting full names of players born after 1999-01-01}
\end{figure}
\pagebreak

\section{Find matches without 1 or 2}
\begin{lstlisting}
SELECT matchID, match_date 
FROM matches
WHERE home_teamId NOT IN (1, 2) AND away_teamID NOT IN (1, 2);
\end{lstlisting}
\begin{figure}[ht]
    \centering
    \includegraphics{No12.png}
    \caption{Finding matches without teams 1 or 2}
\end{figure}
\pagebreak

\section{Classify players by height}
\begin{lstlisting}
SELECT CONCAT(first_name, ' ', last_name) full_name,
IF( height_cm > 180, 'YES', 'NO') AS is_tall 
FROM players;
\end{lstlisting}
\begin{figure}[ht]
    \centering
    \includegraphics{IsTall.png}
    \caption{Classifying players by height}
\end{figure}
\pagebreak

\section{Find player birthdays}
\begin{lstlisting}
SELECT CONCAT(first_name, ' ', last_name) full_name,
DATE_FORMAT(date_of_birth,'%M %d') AS birthday
FROM players;
\end{lstlisting}
\begin{figure}[ht]
    \centering
    \includegraphics{Birthdays.png}
    \caption{Finding player birthdays}
\end{figure}
\pagebreak

\section{Find player BMIs}
\begin{lstlisting}
SELECT playerID,
(weight_kg / ((height_cm / 100) * (height_cm / 100))) AS bmi
FROM players;
\end{lstlisting}
\begin{figure}[ht]
    \centering
    \includegraphics{Bmi.png}
    \caption{Finding player BMIs}
\end{figure}
\pagebreak

\section{Find team 1 opponents}
\begin{lstlisting}
SELECT matchID, match_date, IF(home_teamID = 1, away_teamID, home_teamID) AS opponent
FROM matches
WHERE home_teamID = 1 OR away_teamID = 1;
\end{lstlisting}
\begin{figure}[ht]
    \centering
    \includegraphics{Team1Ops.png}
    \caption{Team 1 opponents}
\end{figure}


\end{document}